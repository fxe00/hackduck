(()=>{console.log("HackDuck injected script loaded");const t=window.fetch;window.fetch=function(...e){const[o,s]=e;console.log("HackDuck: Intercepting fetch request",o);const n={url:"string"==typeof o?o:o.url,method:s?.method||"GET",headers:s?.headers||{},body:s?.body};return console.log("HackDuck: Sending request info",n),window.postMessage({type:"HACKDUCK_REQUEST",data:n},"*"),t.apply(this,e).then(t=>(t.clone().text().then(e=>{const o={};t.headers.forEach((t,e)=>{o[e]=t}),window.postMessage({type:"HACKDUCK_RESPONSE",data:{url:n.url,status:t.status,statusText:t.statusText,headers:o,body:e}},"*")}).catch(t=>{console.log("HackDuck: Error reading response body",t)}),t))};const e=XMLHttpRequest.prototype.open,o=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.open=function(t,o,s=!0,n,c){return this._hackduckMethod=t,this._hackduckUrl=o.toString(),e.call(this,t,o,s,n,c)},XMLHttpRequest.prototype.send=function(t){return window.postMessage({type:"HACKDUCK_REQUEST",data:{url:this._hackduckUrl,method:this._hackduckMethod,headers:this.getAllResponseHeaders?this.getAllResponseHeaders().split("\r\n").reduce((t,e)=>{const[o,s]=e.split(": ");return o&&s&&(t[o]=s),t},{}):{},body:t}},"*"),o.apply(this,[t])},console.log("HackDuck injected script loaded")})();
//# sourceMappingURL=injected.js.map