{"version":3,"file":"injected.js","mappings":"MACAA,QAAQC,IAAI,mCAEZ,MAAMC,EAAgBC,OAAOC,MAC7BD,OAAOC,MAAQ,YAAaC,GACxB,MAAOC,EAAUC,GAAUF,EAC3BL,QAAQC,IAAI,uCAAwCK,GAEpD,MAAME,EAAc,CAChBC,IAAyB,iBAAbH,EAAwBA,EAAWA,EAASG,IACxDC,OAAQH,GAAQG,QAAU,MAC1BC,QAASJ,GAAQI,SAAW,CAAC,EAC7BC,KAAML,GAAQK,MASlB,OAPAZ,QAAQC,IAAI,iCAAkCO,GAE9CL,OAAOU,YAAY,CACfC,KAAM,mBACNC,KAAMP,GACP,KAEIN,EAAcc,MAAMC,KAAMZ,GAAMa,KAAKC,IAEjBA,EAASC,QAEjBC,OAAOH,KAAKI,IAEvB,MAAMC,EAAkB,CAAC,EACzBJ,EAASR,QAAQa,QAAQ,CAACC,EAAOC,KAC7BH,EAAgBG,GAAOD,IAG3BtB,OAAOU,YAAY,CACfC,KAAM,oBACNC,KAAM,CACFN,IAAKD,EAAYC,IACjBkB,OAAQR,EAASQ,OACjBC,WAAYT,EAASS,WACrBjB,QAASY,EACTX,KAAMU,IAEX,OACJO,MAAMC,IACL9B,QAAQC,IAAI,wCAAyC6B,KAElDX,GAEf,EAEA,MAAMY,EAAkBC,eAAeC,UAAUC,KAC3CC,EAAkBH,eAAeC,UAAUG,KACjDJ,eAAeC,UAAUC,KAAO,SAAUxB,EAAQD,EAAK4B,GAAQ,EAAMC,EAAUC,GAG3E,OAFAtB,KAAKuB,gBAAkB9B,EACvBO,KAAKwB,aAAehC,EAAIiC,WACjBX,EAAgBY,KAAK1B,KAAMP,EAAQD,EAAK4B,EAAOC,EAAUC,EACpE,EACAP,eAAeC,UAAUG,KAAO,SAAUrB,GAkBtC,OAfAZ,OAAOU,YAAY,CACfC,KAAM,mBACNC,KAAM,CACFN,IALaQ,KAKKwB,aAClB/B,OANaO,KAMQuB,gBACrB7B,QAASM,KAAK2B,sBACV3B,KAAK2B,wBAAwBC,MAAM,QAAQC,OAAO,CAACC,EAAKC,KACpD,MAAOtB,EAAKD,GAASuB,EAAOH,MAAM,MAGlC,OAFInB,GAAOD,IACPsB,EAAIrB,GAAOD,GACRsB,GACR,CAAC,GAAK,CAAC,EACdnC,KAAMG,IAEX,KACIoB,EAAgBnB,MAAMC,KAAM,CAACF,GACxC,EACAf,QAAQC,IAAI,kC","sources":["webpack://hackduck/./src/injected.ts"],"sourcesContent":["// 注入到页面的脚本，用于拦截fetch和XMLHttpRequest\nconsole.log('HackDuck injected script loaded');\n// 拦截fetch请求\nconst originalFetch = window.fetch;\nwindow.fetch = function (...args) {\n    const [resource, config] = args;\n    console.log('HackDuck: Intercepting fetch request', resource);\n    // 发送请求信息到content script\n    const requestInfo = {\n        url: typeof resource === 'string' ? resource : resource.url,\n        method: config?.method || 'GET',\n        headers: config?.headers || {},\n        body: config?.body\n    };\n    console.log('HackDuck: Sending request info', requestInfo);\n    // 通知扩展\n    window.postMessage({\n        type: 'HACKDUCK_REQUEST',\n        data: requestInfo\n    }, '*');\n    // 拦截响应\n    return originalFetch.apply(this, args).then(response => {\n        // 克隆响应以便读取内容\n        const clonedResponse = response.clone();\n        // 读取响应体\n        clonedResponse.text().then(responseBody => {\n            // 获取响应头\n            const responseHeaders = {};\n            response.headers.forEach((value, key) => {\n                responseHeaders[key] = value;\n            });\n            // 发送响应信息\n            window.postMessage({\n                type: 'HACKDUCK_RESPONSE',\n                data: {\n                    url: requestInfo.url,\n                    status: response.status,\n                    statusText: response.statusText,\n                    headers: responseHeaders,\n                    body: responseBody\n                }\n            }, '*');\n        }).catch(error => {\n            console.log('HackDuck: Error reading response body', error);\n        });\n        return response;\n    });\n};\n// 拦截XMLHttpRequest\nconst originalXHROpen = XMLHttpRequest.prototype.open;\nconst originalXHRSend = XMLHttpRequest.prototype.send;\nXMLHttpRequest.prototype.open = function (method, url, async = true, username, password) {\n    this._hackduckMethod = method;\n    this._hackduckUrl = url.toString();\n    return originalXHROpen.call(this, method, url, async, username, password);\n};\nXMLHttpRequest.prototype.send = function (data) {\n    const extendedThis = this;\n    // 发送请求信息\n    window.postMessage({\n        type: 'HACKDUCK_REQUEST',\n        data: {\n            url: extendedThis._hackduckUrl,\n            method: extendedThis._hackduckMethod,\n            headers: this.getAllResponseHeaders ?\n                this.getAllResponseHeaders().split('\\r\\n').reduce((acc, header) => {\n                    const [key, value] = header.split(': ');\n                    if (key && value)\n                        acc[key] = value;\n                    return acc;\n                }, {}) : {},\n            body: data\n        }\n    }, '*');\n    return originalXHRSend.apply(this, [data]);\n};\nconsole.log('HackDuck injected script loaded');\n"],"names":["console","log","originalFetch","window","fetch","args","resource","config","requestInfo","url","method","headers","body","postMessage","type","data","apply","this","then","response","clone","text","responseBody","responseHeaders","forEach","value","key","status","statusText","catch","error","originalXHROpen","XMLHttpRequest","prototype","open","originalXHRSend","send","async","username","password","_hackduckMethod","_hackduckUrl","toString","call","getAllResponseHeaders","split","reduce","acc","header"],"sourceRoot":""}