{"version":3,"file":"content.js","mappings":"AAEAA,QAAQC,IAAI,kCAEZC,OAAOC,QAAQC,UAAUC,YAAY,CAACC,EAASC,EAAQC,KACnD,GAAqB,qBAAjBF,EAAQG,KAERT,QAAQC,IAAI,sCAAuCK,EAAQI,WAE1D,GAAqB,iBAAjBJ,EAAQG,KAGb,OAIRE,eAAiCC,EAAaJ,GAC1C,IACI,MAAMK,EAAYC,KAAKC,MAEjBC,EAAiB,CACnBC,OAAQL,EAAYK,OACpBC,KAAM,UACNC,YAAa,OACbC,QAAS,CAEL,OAAU,QAIdR,EAAYS,OACZL,EAAeK,KAAOT,EAAYS,MAEtCrB,QAAQC,IAAI,mBAAoB,CAC5BqB,IAAKV,EAAYU,IACjBL,OAAQL,EAAYK,OACpBG,QAASJ,EAAeI,UAE5B,MAAMG,QAAiBC,MAAMZ,EAAYU,IAAKN,GACxCS,EAAeX,KAAKC,MAAQF,EAC5Ba,EAAkB,CAAC,EAEzBH,EAASH,QAAQO,QAAQ,CAACC,EAAOC,KAC7BH,EAAgBG,GAAOD,IAG3B,MAAME,QAAqBP,EAASQ,OACpC/B,QAAQC,IAAI,qBAAsB,CAC9B+B,OAAQT,EAASS,OACjBP,eACAL,QAASM,IAEblB,EAAa,CACTyB,SAAS,EACTD,OAAQT,EAASS,OACjBP,eACAL,QAASM,EACTL,KAAMS,GAEd,CACA,MAAOI,GACHlC,QAAQkC,MAAM,kBAAmBA,GACjC1B,EAAa,CACTyB,SAAS,EACTC,MAAOA,EAAM5B,SAAW,iBAEhC,CACJ,CAxDQ6B,CAAkB7B,EAAQI,KAAMF,IACzB","sources":["webpack://hackduck/./src/content.ts"],"sourcesContent":["// Content script for HackDuck\n// 这个脚本在页面中运行，用于与页面交互\nconsole.log('HackDuck content script loaded');\n// 监听来自background script的消息\nchrome.runtime.onMessage.addListener((message, sender, sendResponse) => {\n    if (message.type === 'REQUEST_CAPTURED') {\n        // 可以在这里添加页面级别的请求处理逻辑\n        console.log('Request captured in content script:', message.data);\n    }\n    else if (message.type === 'SEND_REQUEST') {\n        // 处理发送请求的消息\n        handleSendRequest(message.data, sendResponse);\n        return true; // 保持消息通道开放\n    }\n});\n// 处理发送请求\nasync function handleSendRequest(requestData, sendResponse) {\n    try {\n        const startTime = Date.now();\n        // 构建请求选项，处理CORS问题\n        const requestOptions = {\n            method: requestData.method,\n            mode: 'no-cors', // 使用no-cors模式避免CORS问题\n            credentials: 'omit', // 不发送凭据，避免CORS问题\n            headers: {\n                // 只保留基本的请求头，避免CORS问题\n                'Accept': '*/*'\n            }\n        };\n        // 如果有请求体，添加到选项中\n        if (requestData.body) {\n            requestOptions.body = requestData.body;\n        }\n        console.log('Sending request:', {\n            url: requestData.url,\n            method: requestData.method,\n            headers: requestOptions.headers\n        });\n        const response = await fetch(requestData.url, requestOptions);\n        const responseTime = Date.now() - startTime;\n        const responseHeaders = {};\n        // 获取响应头\n        response.headers.forEach((value, key) => {\n            responseHeaders[key] = value;\n        });\n        // 获取响应体\n        const responseBody = await response.text();\n        console.log('Request completed:', {\n            status: response.status,\n            responseTime,\n            headers: responseHeaders\n        });\n        sendResponse({\n            success: true,\n            status: response.status,\n            responseTime,\n            headers: responseHeaders,\n            body: responseBody\n        });\n    }\n    catch (error) {\n        console.error('Request failed:', error);\n        sendResponse({\n            success: false,\n            error: error.message || 'Unknown error'\n        });\n    }\n}\n// 暂时禁用injected script监听，避免与webRequest冲突\n// window.addEventListener('message', (event) => {\n//   if (event.source !== window) return;\n//   \n//   if (event.data.type === 'HACKDUCK_REQUEST') {\n//     console.log('Request intercepted from injected script:', event.data.data);\n//     \n//     // 转发给background script\n//     chrome.runtime.sendMessage({\n//       type: 'REQUEST_CAPTURED',\n//       data: {\n//         id: `injected-${Date.now()}-${Math.random()}`,\n//         url: event.data.data.url,\n//         method: event.data.data.method,\n//         headers: event.data.data.headers || {},\n//         body: event.data.data.body,\n//         timestamp: Date.now(),\n//         tabId: null // 将在background script中设置\n//       }\n//     });\n//   } else if (event.data.type === 'HACKDUCK_RESPONSE') {\n//     console.log('Response intercepted from injected script:', event.data.data);\n//     \n//     // 转发响应信息给background script\n//     chrome.runtime.sendMessage({\n//       type: 'RESPONSE_CAPTURED',\n//       data: event.data.data\n//     });\n//   }\n// });\n// 暂时禁用injected script注入，避免与webRequest冲突\n// const script = document.createElement('script');\n// script.src = chrome.runtime.getURL('injected.js');\n// script.onload = function() {\n//   const element = this as HTMLScriptElement;\n//   if (element.parentNode) {\n//     element.parentNode.removeChild(element);\n//   }\n// };\n// (document.head || document.documentElement).appendChild(script);\n"],"names":["console","log","chrome","runtime","onMessage","addListener","message","sender","sendResponse","type","data","async","requestData","startTime","Date","now","requestOptions","method","mode","credentials","headers","body","url","response","fetch","responseTime","responseHeaders","forEach","value","key","responseBody","text","status","success","error","handleSendRequest"],"sourceRoot":""}